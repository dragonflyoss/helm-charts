
injector:
  # -- Enable injector.
  enable: false
  # -- Injector name.
  name: injector
  # -- Number of Pods to launch.
  replicas: 2
  image:
    # -- Image registry.
    registry: docker.io
    # -- Image repository.
    repository: dragonflyoss/injector
    # -- Image tag.
    tag: latest
    # -- Image digest.
    digest: ""
    # -- Image pull policy.
    pullPolicy: IfNotPresent
    # -- Image pull secrets.
    pullSecrets: []
  # -- Pod resource requests and limits.
  resources:
    requests:
      cpu: "100m"
      memory: "128Mi"
    limits:
      cpu: "500m"
      memory: "512Mi"
  # -- Pod priorityClassName.
  priorityClassName: ""
  # -- Node labels for pod assignment.
  nodeSelector: {}
  # -- List of node taints to tolerate.
  tolerations: []
  # -- Pod annotations.
  podAnnotations: {}
  # -- Pod labels.
  podLabels: {}
  # -- Update strategy for replicas.
  updateStrategy:
    type: RollingUpdate
  # -- Webhook service port.
  webhookPort: 9443
  # -- Metrics service port.
  metricsPort: 8443
  # -- Health probe port.
  healthPort: 8081
  # -- Enable secure metrics serving.
  metricsSecure: true
  # -- Pod affinity.
  affinity:
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - weight: 100
          podAffinityTerm:
            labelSelector:
              matchLabels:
                app: dragonfly
                component: injector
            topologyKey: kubernetes.io/hostname
  service:
    # -- Service type.
    type: ClusterIP
  # -- Liveness probe configuration.
  livenessProbe:
    initialDelaySeconds: 15
    periodSeconds: 20
    timeoutSeconds: 5
    failureThreshold: 3
  # -- Readiness probe configuration.
  readinessProbe:
    initialDelaySeconds: 5
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3
  # -- Leader election configuration.
  leaderElection:
    enable: true
  # -- Cert-manager configuration.
  certManager:
    enable: true
    secretName: dragonfly-injector-webhook-cert
    duration: 8760h
    renewBefore: 720h
  # -- Webhook configuration.
  webhook:
    failurePolicy: Fail
    timeoutSeconds: 10
    caBundle: ""
    namespaceSelector:
      matchExpressions:
        - key: dragonfly.io/inject
          operator: In
          values:
            - "true"
        - key: kubernetes.io/metadata.name
          operator: NotIn
          values:
            - kube-system
            - kube-public
            - kube-node-lease
            - dragonfly-system
  # -- Injector configuration.
  config:
    enable: true
    proxy_port: 4001
    cli_tools_image: "dragonflyoss/toolkits:latest"
    cli_tools_dir_path: "/dragonfly-tools"
